<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="214.71px" preserveAspectRatio="none" style="width:527px;height:214px;background:#FFFFFF;" version="1.1" viewBox="0 0 527 214" width="527.85px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.255;stroke-dasharray:5.0,5.0;" x1="12.75" x2="12.75" y1="19.9513" y2="195.2839"/><line style="stroke:#181818;stroke-width:0.255;stroke-dasharray:5.0,5.0;" x1="510" x2="510" y1="19.9513" y2="195.2839"/><rect fill="#E2E2F0" height="16.8913" rx="1.275" ry="1.275" style="stroke:#181818;stroke-width:0.255;" width="20.91" x="2.55" y="2.55"/><text fill="#000000" font-family="sans-serif" font-size="7.14" lengthAdjust="spacing" textLength="13.77" x="6.12" y="14.3024">APP</text><rect fill="#E2E2F0" height="16.8913" rx="1.275" ry="1.275" style="stroke:#181818;stroke-width:0.255;" width="20.91" x="2.55" y="194.7739"/><text fill="#000000" font-family="sans-serif" font-size="7.14" lengthAdjust="spacing" textLength="13.77" x="6.12" y="206.5263">APP</text><rect fill="#E2E2F0" height="16.8913" rx="1.275" ry="1.275" style="stroke:#181818;stroke-width:0.255;" width="29.07" x="495.72" y="2.55"/><text fill="#000000" font-family="sans-serif" font-size="7.14" lengthAdjust="spacing" textLength="21.93" x="499.29" y="14.3024">Device</text><rect fill="#E2E2F0" height="16.8913" rx="1.275" ry="1.275" style="stroke:#181818;stroke-width:0.255;" width="29.07" x="495.72" y="194.7739"/><text fill="#000000" font-family="sans-serif" font-size="7.14" lengthAdjust="spacing" textLength="21.93" x="499.29" y="206.5263">Device</text><polygon fill="#181818" points="504.135,35.126,509.235,37.166,504.135,39.206,506.175,37.166" style="stroke:#181818;stroke-width:0.51;"/><line style="stroke:#181818;stroke-width:0.51;stroke-dasharray:2.0,2.0;" x1="13.005" x2="507.195" y1="37.166" y2="37.166"/><text fill="#000000" font-family="sans-serif" font-size="6.63" lengthAdjust="spacing" textLength="35.19" x="16.575" y="34.6892">connect Ble</text><polygon fill="#181818" points="18.615,51.3207,13.515,53.3607,18.615,55.4007,16.575,53.3607" style="stroke:#181818;stroke-width:0.51;"/><line style="stroke:#181818;stroke-width:0.51;stroke-dasharray:2.0,2.0;" x1="15.555" x2="509.745" y1="53.3607" y2="53.3607"/><text fill="#000000" font-family="sans-serif" font-size="6.63" lengthAdjust="spacing" textLength="80.07" x="21.675" y="50.884">response(14,random_code)</text><line style="stroke:#181818;stroke-width:0.51;" x1="13.005" x2="34.425" y1="78.6102" y2="78.6102"/><line style="stroke:#181818;stroke-width:0.51;" x1="34.425" x2="34.425" y1="78.6102" y2="85.2402"/><line style="stroke:#181818;stroke-width:0.51;" x1="13.515" x2="34.425" y1="85.2402" y2="85.2402"/><polygon fill="#181818" points="18.615,83.2002,13.515,85.2402,18.615,87.2802,16.575,85.2402" style="stroke:#181818;stroke-width:0.51;"/><text fill="#000000" font-family="sans-serif" font-size="6.63" lengthAdjust="spacing" textLength="146.37" x="16.575" y="67.0787">&#20351;&#29992;ECDH&#31639;&#27861;EccKey.getPubK()&#29983;&#25104;&#20844;&#38053;&#12289;&#23494;&#38053;</text><text fill="#000000" font-family="sans-serif" font-size="6.63" lengthAdjust="spacing" textLength="81.09" x="16.575" y="76.1334">(app_pub_key,app_pri_key)</text><polygon fill="#181818" points="504.135,99.395,509.235,101.435,504.135,103.475,506.175,101.435" style="stroke:#181818;stroke-width:0.51;"/><line style="stroke:#181818;stroke-width:0.51;" x1="13.005" x2="507.195" y1="101.435" y2="101.435"/><text fill="#000000" font-family="sans-serif" font-size="6.63" lengthAdjust="spacing" textLength="131.07" x="16.575" y="98.9582">send_command(1,app_pub_key,timestamp))</text><polygon fill="#181818" points="18.615,115.5897,13.515,117.6297,18.615,119.6697,16.575,117.6297" style="stroke:#181818;stroke-width:0.51;"/><line style="stroke:#181818;stroke-width:0.51;stroke-dasharray:2.0,2.0;" x1="15.555" x2="509.745" y1="117.6297" y2="117.6297"/><text fill="#000000" font-family="sans-serif" font-size="6.63" lengthAdjust="spacing" textLength="191.25" x="21.675" y="115.1529">response_command(response,command,status,device_pub_key)</text><line style="stroke:#181818;stroke-width:0.51;" x1="13.005" x2="34.425" y1="133.8244" y2="133.8244"/><line style="stroke:#181818;stroke-width:0.51;" x1="34.425" x2="34.425" y1="133.8244" y2="140.4544"/><line style="stroke:#181818;stroke-width:0.51;" x1="13.515" x2="34.425" y1="140.4544" y2="140.4544"/><polygon fill="#181818" points="18.615,138.4144,13.515,140.4544,18.615,142.4944,16.575,140.4544" style="stroke:#181818;stroke-width:0.51;"/><text fill="#000000" font-family="sans-serif" font-size="6.63" lengthAdjust="spacing" textLength="272.34" x="16.575" y="131.3477">&#20351;&#29992;ECDH&#31639;&#27861;EccKey.ecdh(device_pub_key)&#29983;&#25104;&#20849;&#20139;&#20844;&#38053;-&gt;ecdhSecret(&#20379;AESCMAC&#20351;&#29992;)</text><line style="stroke:#181818;stroke-width:0.51;" x1="13.005" x2="34.425" y1="156.6492" y2="156.6492"/><line style="stroke:#181818;stroke-width:0.51;" x1="34.425" x2="34.425" y1="156.6492" y2="163.2792"/><line style="stroke:#181818;stroke-width:0.51;" x1="13.515" x2="34.425" y1="163.2792" y2="163.2792"/><polygon fill="#181818" points="18.615,161.2392,13.515,163.2792,18.615,165.3192,16.575,163.2792" style="stroke:#181818;stroke-width:0.51;"/><text fill="#000000" font-family="sans-serif" font-size="6.63" lengthAdjust="spacing" textLength="490.11" x="16.575" y="154.1724">ecdhSecret &#21644;random_code &#20316;&#20026;AESCMAC&#31639;&#27861;&#30340;key&#12289;Message&#29983;&#25104;&#28040;&#24687;&#30721;&#12290;AesCmac(ecdhSecret,16).computeMac(random_code)-&gt;sessionAuth(&#20379;AESCCM&#20351;&#29992;)</text><line style="stroke:#181818;stroke-width:0.51;" x1="13.005" x2="34.425" y1="179.4739" y2="179.4739"/><line style="stroke:#181818;stroke-width:0.51;" x1="34.425" x2="34.425" y1="179.4739" y2="186.1039"/><line style="stroke:#181818;stroke-width:0.51;" x1="13.515" x2="34.425" y1="186.1039" y2="186.1039"/><polygon fill="#181818" points="18.615,184.0639,13.515,186.1039,18.615,188.1439,16.575,186.1039" style="stroke:#181818;stroke-width:0.51;"/><text fill="#000000" font-family="sans-serif" font-size="6.63" lengthAdjust="spacing" textLength="314.16" x="16.575" y="176.9971">deviceSecret&#21644;random_code&#20316;&#20026;AESCCM&#30340;key&#12289;Message&#21019;&#24314;&#21152;&#23494;&#23545;&#35937;-&gt;cipher(&#23545;Ble&#25968;&#25454;&#20256;&#36755;&#21152;&#23494;&#35299;&#23494;)</text><!--SRC=[TLBBIiD05DttAx9C82CKn8L88AO5eGG2ReKI9nSRD0yoYU3EYaeH1V61e88L4GN5Ae9erVenvb7_mjkEiLLnCzpCd7FkEVT6DGn2b18isXJ61UgvBj1Gc5o0WceO4uJaBm4mttCPYCLHEJ1TotEgrBD0AlHmHC5ZN8XVtxAzox9Mcifk3jBx_JAb5LWQcOFGY6OhefJjdQIDxMJj-cFd_7svdhJMiPXnHTFtgtuqMvs79RbV1tQlvje2KOJS10FNmhQEWmR4eZpC2sq7M6WwlYGLE5p0N4BVL-xzcvfVo5yNCZB3YCbMdvXh3cVx9nfGgoR-OkKfx-Bs5SzAb1vk6cW0eHXtZjJojAQh6jUK1aq6A27PsHoQCaxsE7viV_6uW-nm5RlX67LWp9m3tZPzQAJrLjQilo-lgC0qnwJYG5OkZaaZcDcFGj3nPNYHH64eP7kk6eMrtAMc_p79qtAzdou79ZNzjxkaSPGyjvED9YuzQJrrxqw9Gcs_1e68d_YxfVktwTPD_DBiTdOvh7jnXYSkuHC0]--></g></svg>
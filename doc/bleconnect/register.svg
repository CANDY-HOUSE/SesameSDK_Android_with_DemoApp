<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="421px" preserveAspectRatio="none" style="width:1035px;height:421px;background:#FFFFFF;" version="1.1" viewBox="0 0 1035 421" width="1035px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="25" x2="25" y1="39.1201" y2="382.9097"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1000" x2="1000" y1="39.1201" y2="382.9097"/><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="12" y="28.0439">APP</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="5" y="381.9097"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="12" y="404.9536">APP</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="972" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="979" y="28.0439">Device</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="972" y="381.9097"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="979" y="404.9536">Device</text><polygon fill="#181818" points="988.5,68.8745,998.5,72.8745,988.5,76.8745,992.5,72.8745" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="25.5" x2="994.5" y1="72.8745" y2="72.8745"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="32.5" y="68.0181">connect Ble</text><polygon fill="#181818" points="36.5,100.6289,26.5,104.6289,36.5,108.6289,32.5,104.6289" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30.5" x2="999.5" y1="104.6289" y2="104.6289"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="42.5" y="99.7725">response(14,random_code)</text><line style="stroke:#181818;stroke-width:1.0;" x1="25.5" x2="67.5" y1="154.1377" y2="154.1377"/><line style="stroke:#181818;stroke-width:1.0;" x1="67.5" x2="67.5" y1="154.1377" y2="167.1377"/><line style="stroke:#181818;stroke-width:1.0;" x1="26.5" x2="67.5" y1="167.1377" y2="167.1377"/><polygon fill="#181818" points="36.5,163.1377,26.5,167.1377,36.5,171.1377,32.5,167.1377" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="32.5" y="131.5269">&#20351;&#29992;ECDH&#31639;&#27861;EccKey.getPubK()&#29983;&#25104;&#20844;&#38053;&#12289;&#23494;&#38053;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="32.5" y="149.2813">(app_pub_key,app_pri_key)</text><polygon fill="#181818" points="988.5,194.8921,998.5,198.8921,988.5,202.8921,992.5,198.8921" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="25.5" x2="994.5" y1="198.8921" y2="198.8921"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="32.5" y="194.0356">send_command(1,app_pub_key,timestamp))</text><polygon fill="#181818" points="36.5,226.6465,26.5,230.6465,36.5,234.6465,32.5,230.6465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="30.5" x2="999.5" y1="230.6465" y2="230.6465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375" x="42.5" y="225.79">response_command(response,command,status,device_pub_key)</text><line style="stroke:#181818;stroke-width:1.0;" x1="25.5" x2="67.5" y1="262.4009" y2="262.4009"/><line style="stroke:#181818;stroke-width:1.0;" x1="67.5" x2="67.5" y1="262.4009" y2="275.4009"/><line style="stroke:#181818;stroke-width:1.0;" x1="26.5" x2="67.5" y1="275.4009" y2="275.4009"/><polygon fill="#181818" points="36.5,271.4009,26.5,275.4009,36.5,279.4009,32.5,275.4009" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="534" x="32.5" y="257.5444">&#20351;&#29992;ECDH&#31639;&#27861;EccKey.ecdh(device_pub_key)&#29983;&#25104;&#20849;&#20139;&#20844;&#38053;-&gt;ecdhSecret(&#20379;AESCMAC&#20351;&#29992;)</text><line style="stroke:#181818;stroke-width:1.0;" x1="25.5" x2="67.5" y1="307.1553" y2="307.1553"/><line style="stroke:#181818;stroke-width:1.0;" x1="67.5" x2="67.5" y1="307.1553" y2="320.1553"/><line style="stroke:#181818;stroke-width:1.0;" x1="26.5" x2="67.5" y1="320.1553" y2="320.1553"/><polygon fill="#181818" points="36.5,316.1553,26.5,320.1553,36.5,324.1553,32.5,320.1553" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="961" x="32.5" y="302.2988">ecdhSecret &#21644;random_code &#20316;&#20026;AESCMAC&#31639;&#27861;&#30340;key&#12289;Message&#29983;&#25104;&#28040;&#24687;&#30721;&#12290;AesCmac(ecdhSecret,16).computeMac(random_code)-&gt;sessionAuth(&#20379;AESCCM&#20351;&#29992;)</text><line style="stroke:#181818;stroke-width:1.0;" x1="25.5" x2="67.5" y1="351.9097" y2="351.9097"/><line style="stroke:#181818;stroke-width:1.0;" x1="67.5" x2="67.5" y1="351.9097" y2="364.9097"/><line style="stroke:#181818;stroke-width:1.0;" x1="26.5" x2="67.5" y1="364.9097" y2="364.9097"/><polygon fill="#181818" points="36.5,360.9097,26.5,364.9097,36.5,368.9097,32.5,364.9097" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="616" x="32.5" y="347.0532">deviceSecret&#21644;random_code&#20316;&#20026;AESCCM&#30340;key&#12289;Message&#21019;&#24314;&#21152;&#23494;&#23545;&#35937;-&gt;cipher(&#23545;Ble&#25968;&#25454;&#20256;&#36755;&#21152;&#23494;&#35299;&#23494;)</text><!--SRC=[TLBBIiD05DttAx9C82CKn8L88AO5eGG2ReKI9nSRD0yoYU3EYaeH1V61e88L4GN5Ae9erVenvb7_mjkEiLLnCzpCd7FkEVT6DGn2b18isXJ61UgvBj1Gc5o0WceO4uJaBm4mttCPYCLHEJ1TotEgrBD0AlHmHC5ZN8XVtxAzox9Mcifk3jBx_JAb5LWQcOFGY6OhefJjdQIDxMJj-cFd_7svdhJMiPXnHTFtgtuqMvs79RbV1tQlvje2KOJS10FNmhQEWmR4eZpC2sq7M6WwlYGLE5p0N4BVL-xzcvfVo5yNCZB3YCbMdvXh3cVx9nfGgoR-OkKfx-Bs5SzAb1vk6cW0eHXtZjJojAQh6jUK1aq6A27PsHoQCaxsE7viV_6uW-nm5RlX67LWp9m3tZPzQAJrLjQilo-lgC0qnwJYG5OkZaaZcDcFGj3nPNYHH64eP7kk6eMrtAMc_p79qtAzdou79ZNzjxkaSPGyjvED9YuzQJrrxqw9Gcs_1e68d_YxfVktwTPD_DBiTdOvh7jnXYSkuHC0]--></g></svg>